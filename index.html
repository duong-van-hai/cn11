<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ Thống Kiểm Tra Công Nghệ 11</title>
    <style>
        :root { --primary: #2563eb; --success: #22c55e; --error: #ef4444; --bg: #f1f5f9; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); padding: 20px; line-height: 1.5; }
        .container { max-width: 850px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .header { text-align: center; border-bottom: 2px solid #eee; margin-bottom: 30px; }
        .section-tag { background: #dbeafe; color: #1e40af; padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; margin-bottom: 10px; display: inline-block; }
        .question-box { margin-bottom: 30px; padding: 15px; border: 1px solid #e5e7eb; border-radius: 8px; }
        .option { display: flex; align-items: center; padding: 10px; border: 1px solid #f3f4f6; margin: 8px 0; border-radius: 6px; cursor: pointer; transition: 0.2s; }
        .option:hover { background: #f9fafb; border-color: #d1d5db; }
        input[type="radio"], input[type="checkbox"] { margin-right: 12px; width: 18px; height: 18px; cursor: pointer; }
        .btn-submit { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1.2rem; font-weight: bold; cursor: pointer; }
        .btn-submit:hover { background: #1d4ed8; }
        .result-screen { display: none; text-align: center; }
        .score { font-size: 3rem; font-weight: bold; color: var(--primary); margin: 10px 0; }
        .review-item { text-align: left; padding: 15px; border-bottom: 1px solid #eee; }
        .correct-ans { color: var(--success); font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div id="quiz-ui">
        <div class="header">
            <h1>KIỂM TRA CÔNG NGHỆ 11</h1>
            <p>Thời gian: 15 phút | Tổng: 16 câu</p>
        </div>
        <div id="quiz-content"></div>
        <button class="btn-submit" onclick="submitQuiz()">NỘP BÀI & XEM KẾT QUẢ</button>
    </div>

    <div id="result-ui" class="result-screen">
        <h2>KẾT QUẢ BÀI LÀM</h2>
        <div class="score" id="score-text">0/10</div>
        <p id="stats-text"></p>
        <button onclick="location.reload()" style="padding:10px 20px; cursor:pointer;">Làm đề mới</button>
        <div id="review-content" style="margin-top:30px;"></div>
    </div>
</div>

<script>
// DỮ LIỆU TỪ FILE 11OT1A (12 câu)
const DATA_11OT1A = [
    { q: "Vai trò của cơ khí chế tạo trong ngành giao thông vận tải được thể hiện qua sản phẩm nào?", a: ["Máy chụp cộng hưởng từ (MRI)", "Hệ thống tưới tiêu tự động", "Động cơ ô tô, xe máy", "Máy xay xát lúa gạo"], c: 2 },
    { q: "Trong một dây chuyền sản xuất ô tô, ai là người trực tiếp lắp đặt động cơ vào khung xe?", a: ["Công nhân lắp ráp cơ khí", "Giám đốc nhà máy", "Kỹ sư thiết kế kiểu dáng xe", "Nhân viên bảo vệ nhà máy"], c: 0 },
    { q: "Một trong những tính chất hoá học của vật liệu cơ khí là", a: ["tính cứng", "tính dẫn điện", "tính dẫn nhiệt", "tính chịu ăn mòn"], c: 3 },
    { q: "Tính chất nào sau đây đặc trưng cho khả năng chống lại biến dạng dẻo hay phá hủy của kim loại dưới tác dụng của ngoại lực?", a: ["Tính dẫn nhiệt", "Tính đúc", "Độ bền (tính bền)", "Khối lượng riêng"], c: 2 },
    { q: "Vật liệu nào có thể ghi nhớ được hình dạng ban đầu của nó?", a: ["Vật liệu có cơ tính biến thiên", "Nano", "Hợp kim nhớ hình", "Vật liệu kim loại và hợp kim"], c: 2 },
    { q: "Phương pháp nào sau đây thuộc nhóm “Gia công có phoi” (gia công cắt gọt)?", a: ["Tiện", "Đúc", "Rèn", "Hàn"], c: 0 },
    { q: "Ưu điểm của công nghệ chế tạo phôi bằng phương pháp hàn?", a: ["Mối hàn kém bền", "Mối hàn hở", "Dễ cong vênh", "Tiết kiệm kim loại"], c: 3 },
    { q: "Trên máy tiện vạn năng, chi tiết gắn dao khi tiện là", a: ["mâm cặp", "ụ động", "bàn gá dao", "hộp tốc độ"], c: 2 },
    { q: "Sắp xếp các giai đoạn sau đúng với trình tự của quá trình sản xuất cơ khí?", a: ["Chế tạo phôi -> Gia công -> xử lí và bảo vệ -> lắp ráp -> đóng gói", "Gia công -> chế tạo phôi -> kiểm tra -> lắp ráp -> đóng gói", "Gia công -> chế tạo phôi -> lắp ráp -> kiểm tra -> đóng gói", "Chế tạo phôi -> Gia công -> lắp ráp -> kiểm tra -> đóng gói"], c: 0 },
    { q: "Bước “Xử lý và bảo vệ bề mặt” bao gồm các hoạt động nào sau đây?", a: ["Tiện, phay, bào, khoan", "Đúc, rèn, dập", "Sơn, mạ, phủ hóa chất chống ăn mòn", "Lắp ráp bu lông, đai ốc"], c: 2 },
    { q: "Robot công nghiệp là thiết bị tự động có khả năng gì nổi bật nhất?", a: ["Tự động suy nghĩ như con người", "Thực hiện các thao tác theo chương trình được lập trình sẵn", "Di chuyển với tốc độ ánh sáng", "Tự sửa chữa khi bị hỏng hóc"], c: 1 },
    { q: "Một dây chuyền đóng gói thực phẩm tự động sử dụng robot để xếp thùng carton lên pallet. Đây là ứng dụng của robot trong công đoạn nào?", a: ["Gia công", "Lắp ráp", "Kiểm tra", "Vận chuyển và xếp dỡ"], c: 3 }
];

// DỮ LIỆU TỪ FILE 11OT1B (Trích lọc 12 câu đại diện)
const DATA_11OT1B = [
    { q: "Gia công cơ khí là gì?", a: ["Là quá trình chế tạo sản phẩm cơ khí", "Là quá trình nghiên cứu, thiết kế chi tiết máy", "Là giai đoạn tổ hợp các chi tiết", "Là công việc bảo dưỡng thiết bị"], c: 0 },
    { q: "Lắp ráp sản phẩm cơ khí là gì?", a: ["Quá trình chế tạo sản phẩm", "Thiết kế tính toán kích thước", "Giai đoạn cuối để tổ hợp các chi tiết thành sản phẩm hoàn chỉnh", "Công việc kiểm tra chẩn đoán trạng thái"], c: 2 },
    { q: "Nghề nghiệp thuộc nhóm công việc thiết kế sản phẩm cơ khí là:", a: ["Kĩ sư kĩ thuật cơ khí, kĩ sư cơ điện tử", "Thợ cắt gọt kim loại, thợ hàn", "Kĩ thuật viên máy, công cụ", "Thợ sửa chữa ô tô"], c: 0 },
    { q: "Vật liệu mới là gì?", a: ["Vật liệu không nằm trong danh mục truyền thống", "Vật liệu phi kim loại đang sử dụng", "Vật liệu có tính cơ học ổn định", "Vật liệu giá thành thấp"], c: 0 },
    { q: "Vật liệu nào dưới đây thuộc nhóm kim loại?", a: ["Gạch", "Thủy tinh", "Thép, gang", "Bê tông"], c: 2 },
    { q: "Tính chất nào sau đây thuộc tính cơ học của vật liệu cơ khí?", a: ["Độ cứng, tính dẻo, tính bền", "Tính dẫn điện, dẫn nhiệt", "Tính chịu mòn hóa học", "Màu sắc, khối lượng riêng"], c: 0 },
    { q: "Thép carbon là hợp kim của sắt và carbon với hàm lượng carbon:", a: ["Nhỏ hơn 2,14%", "Từ 2,14% đến 4,3%", "Lớn hơn 4,3%", "Bằng 5%"], c: 0 },
    { q: "Gang là hợp kim có tính chất gì sau đây?", a: ["Tính dẻo", "Tính giòn", "Tính đàn hồi", "Tính chịu ăn mòn tốt"], c: 1 },
    { q: "Đồng thau là hợp kim của kim loại nào?", a: ["Cu-Fe", "Cu-Zn", "Cu-Mg", "Cu-Al"], c: 1 },
    { q: "Nhựa nhiệt dẻo có đặc điểm gì?", a: ["Không dẫn điện, không có khả năng tái sinh", "Nhẹ, không dẫn điện, có khả năng chế biến lại", "Nhiệt độ nóng chảy cao", "Dẫn nhiệt tốt"], c: 1 },
    { q: "Ưu điểm của vật liệu phi kim loại so với kim loại:", a: ["Cách điện, cách nhiệt, nhẹ, chịu ăn mòn hóa học tốt", "Dẫn điện tốt", "Độ cứng cao hơn thép", "Dễ bị oxi hóa"], c: 0 },
    { q: "Phân loại theo công nghệ gia công gồm:", a: ["Gia công không phoi và gia công có phoi", "Gia công truyền thống và gia công điện", "Gia công thủ công và gia công máy", "Đúc và Hàn"], c: 0 }
];

// DỮ LIỆU PHẦN 2 (Ví dụ 4 câu trắc nghiệm nhiều đáp án)
const DATA_PHAN_2 = [
    { q: "Những công nghệ nào thuộc gia công cơ khí không phoi?", a: ["Đúc", "Tiện", "Rèn", "Hàn"], c: [0, 2, 3] },
    { q: "Các loại vật liệu nào sau đây được coi là vật liệu mới?", a: ["Vật liệu Nano", "Gang xám", "Vật liệu Composite", "Hợp kim nhớ hình"], c: [0, 2, 3] },
    { q: "Các tính chất vật lý của vật liệu cơ khí bao gồm?", a: ["Tính dẫn điện", "Tính dẫn nhiệt", "Tính chịu axit", "Nhiệt độ nóng chảy"], c: [0, 1, 3] },
    { q: "Ưu điểm của vật liệu Composite là?", a: ["Độ bền cao", "Nhẹ", "Chịu nhiệt tốt", "Dẫn điện tốt như đồng"], c: [0, 1, 2] }
];

let examQuestions = [];

function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }

function initExam() {
    const p1A = shuffle([...DATA_11OT1A]).slice(0, 6);
    const p1B = shuffle([...DATA_11OT1B]).slice(0, 6);
    const p2 = shuffle([...DATA_PHAN_2]).slice(0, 4);

    const part1 = shuffle([...p1A, ...p1B]);
    
    examQuestions = [...part1, ...p2].map(item => {
        const isMulti = Array.isArray(item.c);
        let options = item.a.map((txt, i) => ({
            text: txt,
            isCorrect: isMulti ? item.c.includes(i) : i === item.c
        }));
        shuffle(options);
        return { question: item.q, type: isMulti ? 'multi' : 'single', options };
    });

    renderQuiz();
}

function renderQuiz() {
    const container = document.getElementById('quiz-content');
    container.innerHTML = examQuestions.map((q, i) => `
        <div class="question-box">
            <span class="section-tag">${i < 12 ? 'Phần I: Một đáp án' : 'Phần II: Nhiều đáp án'}</span>
            <p><strong>Câu ${i + 1}:</strong> ${q.question}</p>
            ${q.options.map((opt, oi) => `
                <label class="option">
                    <input type="${q.type === 'single' ? 'radio' : 'checkbox'}" name="q${i}" value="${oi}">
                    ${opt.text}
                </label>
            `).join('')}
        </div>
    `).join('');
}

function submitQuiz() {
    let score = 0;
    let correctCount = 0;
    let reviewHtml = '';

    examQuestions.forEach((q, i) => {
        const selected = Array.from(document.querySelectorAll(`input[name="q${i}"]:checked`)).map(el => parseInt(el.value));
        const correctIdx = q.options.map((o, oi) => o.isCorrect ? oi : null).filter(v => v !== null);
        
        let isRight = (q.type === 'single') 
            ? (selected.length === 1 && q.options[selected[0]].isCorrect)
            : (JSON.stringify(selected.sort()) === JSON.stringify(correctIdx.sort()));

        if (isRight) correctCount++;
        
        reviewHtml += `
            <div class="review-item">
                <p><strong>Câu ${i+1}:</strong> ${isRight ? '✅' : '❌'}</p>
                <p>Đáp án đúng: <span class="correct-ans">${correctIdx.map(idx => q.options[idx].text).join('; ')}</span></p>
            </div>
        `;
    });

    score = (correctCount / 16) * 10;
    document.getElementById('quiz-ui').style.display = 'none';
    document.getElementById('result-ui').style.display = 'block';
    document.getElementById('score-text').innerText = score.toFixed(1) + "/10";
    document.getElementById('stats-text').innerText = `Đúng ${correctCount} / 16 câu`;
    document.getElementById('review-content').innerHTML = reviewHtml;
    window.scrollTo(0, 0);
}

window.onload = initExam;
</script>
</body>
</html>
